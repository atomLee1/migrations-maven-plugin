<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7 at 11 June 2016 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="The MyBatis Team" />
    <meta name="Date-Revision-yyyymmdd" content="20160611" />
    <meta http-equiv="Content-Language" content="en" />
    <title>MyBatis &#x2013; Examples</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>MyBatis Migrations Maven plugin</h2>
                </div>
                      </div>
        <div class="pull-right">                                <a href="../" id="bannerRight" title="MyBatis logo">
                                                                                        <img src="http://mybatis.github.io/images/mybatis-logo.png"  alt="MyBatis logo"/>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
                  <li id="publishDate">Last Published: 11 June 2016
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.1.3
                      </li>
                      
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Reference Documentation</li>
                              
      <li>
  
                          <a href="index.html" title="Introduction">
          <span class="none"></span>
        Introduction</a>
            </li>
                
      <li>
  
                          <a href="plugin-info.html" title="Goals">
          <span class="none"></span>
        Goals</a>
            </li>
                
      <li>
  
                          <a href="usage.html" title="Usage">
          <span class="none"></span>
        Usage</a>
            </li>
                
      <li class="active">
  
            <a href="#"><span class="none"></span>Examples</a>
          </li>
                
      <li>
  
                          <a href="faq.html" title="FAQ">
          <span class="none"></span>
        FAQ</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                                        
      <li>
  
                          <a href="project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                                                                                            
      <li>
  
                          <a href="project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            

  
  <div class="section">
<h2><a name="Intregrate_migrate_in_Maven_life_cycle"></a>Intregrate migrate in Maven life cycle</h2>
        
<p>
            It can be useful integrate Migration steps into a build life cycle, i.e. integrating the database schema
            creation into a CI build lifecycle.</p>

            
<div class="source"><pre class="prettyprint">&lt;plugins&gt;
  &lt;plugin&gt;
    &lt;groupId&gt;org.mybatis.maven&lt;/groupId&gt;
    &lt;artifactId&gt;migrations-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;X.X&lt;/version&gt;
    &lt;dependencies&gt;
      [ add your jdbc driver depencency ]
    &lt;/dependencies&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;id&gt;apply-all-pending-migration&lt;/id&gt;
        &lt;phase&gt;process-test-resources&lt;/phase&gt;
        &lt;goals&gt;
          &lt;goal&gt;up&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;configuration&gt;
           &lt;repository&gt; [migration repository path] &lt;/repository&gt;
        &lt;/configuration&gt;
      &lt;/execution&gt;
   &lt;/executions&gt;
  &lt;/plugin&gt;
&lt;plugins&gt;</pre></div>

            
<p>If your project uses the sub-modules you can set your parent pom in this way:</p>

            
<div class="source"><pre class="prettyprint">&lt;build&gt;
  &lt;pluginManagement&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.mybatis.maven&lt;/groupId&gt;
        &lt;artifactId&gt;migrations-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;X.X&lt;/version&gt;
        &lt;dependencies&gt;
          [ add your jdbc driver depencency ]
        &lt;/dependencies&gt;
        &lt;configuration&gt;
          &lt;skip&gt;true&lt;/skip&gt;
        &lt;/configuration&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/pluginManagement&gt;

  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.mybatis.maven&lt;/groupId&gt;
      &lt;artifactId&gt;migrations-maven-plugin&lt;/artifactId&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;</pre></div>

            
<p>Then, in submodules:</p>

            
<div class="source"><pre class="prettyprint">&lt;plugins&gt;
  &lt;plugin&gt;
    &lt;groupId&gt;org.mybatis.maven&lt;/groupId&gt;
    &lt;artifactId&gt;migrations-maven-plugin&lt;/artifactId&gt;
    &lt;configuration&gt;
      &lt;repository&gt; [migration repository path] &lt;/repository&gt;
      &lt;skip&gt;false&lt;/skip&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
      &lt;execution&gt;
        &lt;id&gt;migration-chack&lt;/id&gt;
        &lt;phase&gt;test&lt;/phase&gt;
        &lt;goals&gt;
          &lt;goal&gt;check&lt;/goal&gt;
        &lt;/goals&gt;
        &lt;inherited&gt;false&lt;/inherited&gt;
      &lt;/execution&gt;
    &lt;/executions&gt;
  &lt;/plugin&gt;

&lt;plugins&gt;</pre></div>

    </div>

    
<div class="section">
<h2><a name="Use_Migration_commands"></a>Use Migration commands</h2>
        
<p>
            Migration plugin aims to help you to administer your database via MyBatis Schema Migration, so, i.e, you can
            use this plugin to create new migration scripts and to apply the pending scripts to your database.
            The following example will show the common commands to create and administer your database.
        </p>
        
<p>
            First of all you have to initialize your migration repository:</p>

            
<div>
<pre>mvn migration:init -Dmigration.path=/path/to/repository</pre></div>

            
<p>This command inizializes the standard migration repository into <tt>/path/to/repository</tt> folder.</p>

            
<p>After you have to modify and customize your enviroment: edit the file
            <tt>/path/to/repository/enviroments/development.properties</tt> and set the database coordinte.
            So you can apply the first migration to the database:</p>

            
<div>
<pre>mvn migration:up -Dmigration.path=/path/to/repository</pre></div>

            
<p>Now it is possible to create the new script:</p>

            
<div>
<pre>mvn migration:new -Dmigration.path=/path/to/repository -Dmigration.description=my_second_schema_migration</pre></div>

            
<p>the command creates a new empty sql file into the folder <tt>/path/to/repository/scripts</tt>
            like this:</p>

            
<div>
<pre>--// First migration.
-- Migration SQL that makes the change goes here.

--//@UNDO
-- SQL to undo the change goes here.</pre></div>

            
<p>now you can check the current status of your database by executing this the status goal:</p>

            
<div>
<pre>mvn migration:status -Dmigration.path=/path/to/repository

[INFO] Executing  Apache Migration StatusCommand
[INFO] ID             Applied At             Description
[INFO] ================================================================================
[INFO] 20100400000001    2010-04-24 22:51:16    create changelog
[INFO] 20100400000002    2010-04-24 22:51:17    first migration
[INFO] 20100400000003    ...pending...          my second schema migration
[INFO]</pre></div>

            
<p>finally you can apply the last migration pending script:</p>

            
<div>
<pre>mvn migration:up -Dmigration.path=/path/to/repository

mvn migration:status -Dmigration.path=/path/to/repository

[INFO] Executing  Apache Migration StatusCommand
[INFO] ID             Applied At             Description
[INFO] ================================================================================
[INFO] 20100400000001    2010-04-24 22:51:16    create changelog
[INFO] 20100400000002    2010-04-24 22:51:17    first migration
[INFO] 20100400000003    2010-04-24 23:14:07    my second schema migration
[INFO]</pre></div>

    </div>

    
<div class="section">
<h2><a name="Migration_plugin_report"></a>Migration plugin report</h2>
      <img src="./images/migration-mvn.png" alt="Migration plugin report" />
    </div>

    
<div class="section">
<h2><a name="Migration_plugin_report_with_warnings"></a>Migration plugin report with warnings</h2>
      <img src="./images/migration-mvn-warning.png" alt="Migration plugin report with warnings" />
    </div>




                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2010&#x2013;2016
                        <a href="http://www.mybatis.org/">MyBatis.org</a>.
            All rights reserved.    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
